<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>界面拖拽交互</title>
    <style>
        * {margin: 0;padding: 0;}
        body {padding: 40px;}
        .title {margin-bottom: 30px;}
        .title ol {padding-left: 40px;}
        .title ul {padding-left: 20px;}
        .drag-box {position: relative;width: 600px;height: 600px;}
        .drag-box ul {float: left;width: 150px;height: 500px;border: 1px solid #444;}
        .drag-box li {display: block;width: 150px;height: 60px;border-bottom: 1px solid #444;list-style: none;}
        .ul-right {margin-left: 200px;}
    </style>
</head>
<body>
    <div class="title">
        <h2>拖拽交互</h2>
        <h3>效果如下:</h3>
        <ol>
            <li>使用js添加随机颜色，便于显示交互</li>
            <li>存在碰撞时，如下：
                <ul>
                    <li>同一父元素中碰撞，交互位置。</li>
                    <li>不同父元素中碰撞，碰撞到块时，添加到其前。</li>
                    <li>不同父元素中碰撞，未碰撞到块时，删除原位置块，添加到新的父元素。</li>
                </ul>
            </li>
            <li>不存在碰撞时，回答原位置</li>
            <li>自动处理原父元素中剩余块位置(自动往下掉)。</li>
        </ol>
    </div>
    <div class="drag-box">
        <ul class="ul-left">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
        <ul class="ul-right">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </div>
    <script src="js/task0002_1.js"></script>
    <script>
        window.onload = Drag;

        function Drag() {
            var dragBox = $('.drag-box');
            var leftUl = $('.ul-left');
            var rightUl = $('.ul-right');
            var aLi = dragBox.getElementsByTagName('li');

            changeColor(aLi);
            function changeColor(element) {
                for (var i = 0, len = aLi.length; i < len; i++) {
                    aLi[i].style.backgroundColor = '#' + Math.floor(Math.random() * 16777215).toString(16);
                    // aLi[i].style.backgroundColor = '#' + Math.floor(Math.random()*256).toString(10);
                    // aLi[i].style.backgroundColor = '#' + Math.floor(Math.random()*0xffffff).toString(16);
                }
            }

            for (var i = 0; i < aLi.length; i++) {
                aLi[i].style.position = 'absolute';
                if (i < 4) {
                    aLi[i].style.left = 1 + 'px';
                    aLi[i].style.top = i * 61 + 1 + 'px';
                    aLi[i].onmousedown = function(ev) {
                        var clientPos = mousePos(ev);
                        var m = getIndex(this);
                        this.onmousemove = function (e) {
                            var movePos = mousePos(e);
                            this.style.left = movePos.x - clientPos.x + 'px';
                            this.style.top = movePos.y  - clientPos.y + m * 61+ 'px' ;
                        };
                    };
                }
                else {
                    aLi[i].style.left = 353 + 'px';
                    aLi[i].style.top = (i - 4) * 61 + 1 + 'px';
                    aLi[i].onmousedown = function(ev) {
                        var clientPos = mousePos(ev);
                        var m = getIndex(this);
                        this.onmousemove = function (e) {
                            var movePos = mousePos(e);
                            this.style.left = movePos.x - clientPos.x + 353 + 'px';
                            this.style.top = movePos.y  - clientPos.y + m * 61+ 'px' ;
                        };
                    };
                }
            }

            function mousePos(e) {
                var event = e || window.event;
                var mPos = {};
                mPos.x = event.clientX + window.pageXOffset;
                mPos.y = event.clientY + window.pageYOffset;
                return mPos;
            }
        }
    </script>
</body>
</html>